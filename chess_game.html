<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chess</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.css">
<style>
  body { font-family: "Georgia", serif; text-align: center; background: #f4f1ee; }
  #board { width: 400px; margin: 20px auto; }
  #message { font-size: 18px; color: #e74c3c; margin-top: 10px; min-height: 24px; }
  #controls { margin-top: 20px; }
  button { padding: 10px 20px; font-size: 16px; margin: 0 10px; cursor: pointer; }
  select { padding: 5px; font-size: 16px; }
  a { display: inline-block; margin-top: 20px; color: #2980b9; text-decoration: none; }
</style>
</head>
<body>

<h1>Chess</h1>
<div id="board"></div>
<div id="message"></div>

<div id="controls">
  <label for="difficulty">AI Difficulty:</label>
  <select id="difficulty">
    <option value="easy">Easy</option>
    <option value="medium">Medium</option>
    <option value="hard">Hard</option>
  </select>
  <button onclick="restartGame()">Restart</button>
</div>

<a href="index.html">Back to Hub</a>

<script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/1.0.0/chess.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.js"></script>
<script>
let board = null;
let game = new Chess();
let messageEl = document.getElementById("message");

function onDragStart(source, piece, position, orientation) {
    if (game.game_over() ||
        (game.turn() === 'w' && piece.search(/^b/) !== -1) ||
        (game.turn() === 'b' && piece.search(/^w/) !== -1)) {
        return false;
    }
}

function onDrop(source, target) {
    let move = game.move({ from: source, to: target, promotion: 'q' });
    if (move === null) {
        messageEl.textContent = "Illegal move! Try again.";
        return 'snapback';
    } else {
        messageEl.textContent = "";
        window.setTimeout(makeAIMove, 200);
    }
}

function makeAIMove() {
    if (game.game_over()) return;
    let moves = game.moves();
    let difficulty = document.getElementById("difficulty").value;
    let move = null;

    if (difficulty === "easy") {
        move = moves[Math.floor(Math.random() * moves.length)];
    } else if (difficulty === "medium") {
        move = moves[Math.floor(Math.random() * moves.length)]; // placeholder, can use mini-max
    } else if (difficulty === "hard") {
        move = moves[Math.floor(Math.random() * moves.length)]; // placeholder, advanced AI can go here
    }

    game.move(move);
    board.position(game.fen());
}

function onSnapEnd() {
    board.position(game.fen());
}

function restartGame() {
    game.reset();
    board.start();
    messageEl.textContent = "";
}

board = Chessboard('board', {
    draggable: true,
    position: 'start',
    onDragStart: onDragStart,
    onDrop: onDrop,
    onSnapEnd: onSnapEnd
});
</script>
</body>
</html>
